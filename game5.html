<!DOCTYPE html>
<html>
<head>
<title>Color Catcher</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #eee;
  text-align: center;
}

#topPanel {
  background: #222;
  color: white;
  padding: 10px;
  font-size: 18px;
}

#guidelines {
  font-size: 16px;
  margin-top: 5px;
}

#game {
  position: relative;
  width: 800px;
  height: 500px;
  margin: 20px auto;
  background: white;
  border: 3px solid black;
  overflow: hidden;
}

.ball {
  position: absolute;
  width: 30px;
  height: 30px;
  border-radius: 50%;
}

#basket {
  position: absolute;
  bottom: 5px;
  font-size: 50px;
  left: 375px;
}

#result {
  font-size: 26px;
  margin-top: 15px;
  font-weight: bold;
}

button {
  font-size: 18px;
  padding: 10px 20px;
  margin-top: 10px;
  cursor: pointer;
}

a {
  display: inline-block;
  margin-top: 10px;
  font-size: 18px;
}
</style>
</head>

<body>

<div id="topPanel">
  Target Color: <span id="targetColor"></span> |
  Target Points: 80 |
  Time Left: <span id="time">03:00</span> |
  Score: <span id="score">0</span>

  <div id="guidelines">
    Correct ball: +2 points | Wrong ball: âˆ’2 points | Catch 40 target balls to win
  </div>
</div>

<div id="game">
  <div id="basket">ðŸ§º</div>
</div>

<div id="result"></div>
<button id="tryAgainBtn" style="display:none;" onclick="location.reload()">Try Again</button>

<button id="nextLevelLink" style="display:none;" onclick="location.href='game6.html'">
  Next Level
</button>

<script>
const colors = ["red","green","blue","pink","purple","orange"];
const targetColor = colors[Math.floor(Math.random() * colors.length)];

document.getElementById("targetColor").textContent = targetColor.toUpperCase();

let score = 0;
let timeLeft = 180;
let basketX = 375;
let speed = 0;
let gameOver = false;

const game = document.getElementById("game");
const basket = document.getElementById("basket");
const scoreSpan = document.getElementById("score");
const timeSpan = document.getElementById("time");
const resultDiv = document.getElementById("result");
const tryAgainBtn = document.getElementById("tryAgainBtn");
const nextLevelLink = document.getElementById("nextLevelLink");

// Spawn balls
const spawnInterval = setInterval(() => {
  if (gameOver) return;

  const ball = document.createElement("div");
  ball.className = "ball";
  ball.style.background = colors[Math.floor(Math.random() * colors.length)];
  ball.style.left = Math.random() * 770 + "px";
  ball.style.top = "0px";
  game.appendChild(ball);

  const fallInterval = setInterval(() => {
    if (gameOver) {
      clearInterval(fallInterval);
      ball.remove();
      return;
    }

    ball.style.top = ball.offsetTop + 3 + "px";

    const b = ball.getBoundingClientRect();
    const k = basket.getBoundingClientRect();

    if (b.bottom > k.top && b.left < k.right && b.right > k.left) {
      if (ball.style.background === targetColor) {
        score += 2;
      } else {
        score -= 2;
      }

      scoreSpan.textContent = score;
      clearInterval(fallInterval);
      ball.remove();

      if (score >= 80) endGame(true);
    }

    if (ball.offsetTop > 500) {
      clearInterval(fallInterval);
      ball.remove();
    }
  }, 16);
}, 500);

// Timer
const timerInterval = setInterval(() => {
  if (gameOver) return;

  timeLeft--;
  const m = Math.floor(timeLeft / 60);
  const s = timeLeft % 60;
  timeSpan.textContent =
    String(m).padStart(2,"0") + ":" + String(s).padStart(2,"0");

  if (timeLeft === 0 && score < 80) endGame(false);
}, 1000);

// Smooth basket movement
function moveBasket() {
  basketX += speed;
  basketX = Math.max(0, Math.min(750, basketX));
  basket.style.left = basketX + "px";
  requestAnimationFrame(moveBasket);
}
moveBasket();

document.addEventListener("keydown", e => {
  if (e.key === "ArrowLeft") speed = -6;
  if (e.key === "ArrowRight") speed = 6;
});
document.addEventListener("keyup", () => speed = 0);

// End game
function endGame(won) {
  gameOver = true;
  clearInterval(spawnInterval);
  clearInterval(timerInterval);

  if (won) {
    resultDiv.textContent = "LEVEL PASSED";
    nextLevelLink.style.display = "inline-block";
  } else {
    resultDiv.textContent = "TRY AGAIN";
    tryAgainBtn.style.display = "inline-block";
  }
}
</script>

</body>
</html>
